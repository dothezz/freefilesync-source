<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="base.css" >
	<title>Macros</title>
</head>

<body>
	<H2>Macros</H2>

	<P>All directory names may contain macros that are expanded during
	synchronization. Begin and end of each macro is marked by a <B>%</B> character. Besides special macros
	handling time and date, the <B>operating system's environment variables</B> can also be used.
	</P>
	<BR>

	<h3>Internal macros</h3>

	<div class="greybox">
		<div class="greybox_inner">
			<table cellpadding=0 cellspacing=0>
				<tr>
					<th><b>Macro</b></th>
					<th><b>Sample value</b></th>
				</tr>
				<tr>
					<td><span class="command_line">%date%</span></td>
					<td><span class="file_path">2012-12-31&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>format: [YYYY-MM-DD]</td>
				</tr>
				<tr>
					<td><span class="command_line">%time%</span></td>
					<td><span class="file_path">123044&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>format: [hhmmss]</td>
				</tr>			
				<tr>
					<td><span class="command_line">%timestamp%</span></td>
					<td><span class="file_path">2012-12-31 123044&nbsp;</span>format: [YYYY-MM-DD hhmmss]</td>
				</tr>
				<tr><td>&nbsp;</td></tr>
				<tr>
					<td><span class="command_line">%year%</span></td>
					<td><span class="file_path">2012</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%month%</span></td>
					<td><span class="file_path">12</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%day%</span></td>
					<td><span class="file_path">31</span></td>
				</tr>
				<tr><td>&nbsp;</td></tr>
				<tr>
					<td><span class="command_line">%hour%</span></td>
					<td><span class="file_path">12</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%min%</span></td>
					<td><span class="file_path">30</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%sec%</span></td>
					<td><span class="file_path">44</span></td>
				</tr>
				<tr><td>&nbsp;</td></tr>
				<tr>
					<td><span class="command_line">%weekday%</span></td>
					<td><span class="file_path">Monday&nbsp;</span>(day of the week)</td>
				</tr>

				<tr>
					<td><span class="command_line">%week%</span></td>
					<td><span class="file_path">52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>(calendar week)</td>
				</tr>
			</table>
		</div>
	</div>
	<BR CLEAR=LEFT>
	<BR>

	<h3>Environment variables<SPAN STYLE="font-weight: normal"> (Windows)</SPAN></h3>

	<div class="greybox">
		<div class="greybox_inner">
			<table cellpadding=0 cellspacing=0>
				<tr>
					<th><b>Macro</b></th>
					<th><b>Sample value</b></th>
				</tr>
				<tr>
					<td><span class="command_line">%AllUsersProfile%</span></td>
					<td><span class="file_path">C:\ProgramData</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%AppData%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;\AppData\Roaming</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%ComputerName%</span></td>
					<td><span class="file_path">Zenju-PC</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%LocalAppData%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;\AppData\Local</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%ProgramData%</span></td>
					<td><span class="file_path">C:\ProgramData</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%ProgramFiles%</span></td>
					<td><span class="file_path">C:\Program Files</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%ProgramFiles(x86)%</span></td>
					<td><span class="file_path">C:\Program Files (x86)</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%Public%</span></td>
					<td><span class="file_path">C:\Users\Public</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%Temp%</span></td>
					<td><span class="file_path">C:\Windows\Temp</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%UserName%</span></td>
					<td><span class="file_path">Zenju</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%UserProfile%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%WinDir%</span></td>
					<td><span class="file_path">C:\Windows</span></td>
				</tr>
			</table>

		</div>
	</div>
	<BR CLEAR=LEFT>
	<BR>

	<h3>Special folder locations<SPAN STYLE="font-weight: normal"> (Windows)</SPAN></h3>

	<div class="greybox">
		<div class="greybox_inner">
			<table cellpadding=0 cellspacing=0>
				<tr>
					<th><b>Macro</b></th>
					<th><b>Sample value</b></th>
				</tr>		
				<tr>
					<td><span class="command_line">%csidl_Desktop%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;\Desktop</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%csidl_Downloads%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;\Downloads</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%csidl_Favorites%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;\Favorites</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%csidl_MyDocuments%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;\Documents</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%csidl_MyMusic%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;\Music</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%csidl_MyPictures%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;\Pictures</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%csidl_MyVideos%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;\Videos</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%csidl_Nethood%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Network Shortcuts</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%csidl_Programs%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Start Menu\Programs</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%csidl_Quicklaunch%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%csidl_Resources%</span></td>
					<td><span class="file_path">C:\Windows\Resources</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%csidl_StartMenu%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Start Menu</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%csidl_Startup%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\StartUp</span></td>
				</tr>
				<tr>
					<td><span class="command_line">%csidl_Templates%</span></td>
					<td><span class="file_path">C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Templates</span></td>
				</tr>
			</table>
			
			<p>
				<b>Note:</b> Most macros listed here also have a variant for public folders, e.g.
				<span class="command_line">%csidl_MyMusic%</span> has <span class="command_line">%csidl_PublicMusic%</span>.
			</p>
		</div>
	</div>
	<BR CLEAR=LEFT>
	<br>
	<br>

	<P>
	<B>Hint:</B> You can add a great amount of flexibility to a ffs_batch configuration file
	 by creating new temporary environment variables in a bat or cmd file that are evaluated by FreeFileSync at runtime:
	</P>

	<BR>

	<P><B>Example:</B>
	The FreeFileSync batch file <span class="file_path">C:\SyncJob.ffs_batch</span> contains 
	macro <span class="command_line">%MyVar%</span> instead of an absolute target folder and is invoked by a cmd file:
	</P>

	<div class="greybox">
		<div class="greybox_inner">
				<span class="command_line">set MyVar=C:\Target<BR>
					&quot;C:\Program files\FreeFileSync\FreeFileSync.exe&quot; C:\SyncJob.ffs_batch<BR>
					<FONT COLOR="#808080"><I><B>::%MyVar% is resolved as C:\Target during synchronization</B></I></FONT>
				</span>
		</div>
	</div>
	<BR CLEAR=LEFT>
	<BR>

	<div class="bluebox">
		<div class="bluebox_inner">
				<B>Note</B><br>
				Temporary environment variables created with the <span class="command_line">set</span> command are only valid if the synchronization is started by calling the
				FreeFileSync executable directly. Using <span class="command_line">start /wait</span> creates a new program context without these temporal variables.
		</div>
	</div>
	<BR CLEAR=LEFT>
</body>
</html>